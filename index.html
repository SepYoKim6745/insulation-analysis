<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>절연성능 평가 시스템</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>절연성능 평가 시스템</h1>
            <div class="mode-selector">
                <button class="mode-btn active" data-mode="performance">절연성능 평가</button>
                <button class="mode-btn" data-mode="degradation">절연저항 열화 패턴 분류</button>
            </div>
        </header>

        <!-- 절연성능 평가 모드 -->
        <div id="performance-mode" class="mode-content active">
            <h2>절연성능 경향 평가</h2>
            <div class="input-section">
                <div class="input-group">
                    <label for="current-input">전류 (I) [A]:</label>
                    <input type="number" id="current-input" step="0.01" placeholder="전류를 입력하세요">
                </div>
                <div class="input-group">
                    <label for="temperature-input">온도 (T) [℃]:</label>
                    <input type="number" id="temperature-input" step="0.01" placeholder="온도를 입력하세요">
                </div>
                <button id="calculate-performance" class="calculate-btn">평가 계산</button>
            </div>

            <div id="performance-results" class="results-section" style="display: none;">
                <h3>절연 열화 패턴 평가</h3>
                <div class="indicators-table">
                    <table>
                        <thead>
                            <tr>
                                <th>항목</th>
                                <th>계산값</th>
                                <th>위험도</th>
                                <th>레벨</th>
                            </tr>
                        </thead>
                        <tbody id="indicators-tbody">
                        </tbody>
                    </table>
                </div>

                <h3>체크리스트</h3>
                <div id="checklist-section" class="checklist-section">
                </div>
            </div>

            <!-- 절연성능 평가 기록 목록 -->
            <div class="history-section">
                <div class="history-header">
                    <h3>평가 기록</h3>
                    <button id="clear-performance-history" class="clear-btn-small">전체 삭제</button>
                </div>
                <div id="performance-history-list" class="history-list">
                    <!-- 기록 목록이 여기에 표시됩니다 -->
                </div>
                <!-- 그래프 섹션 -->
                <div class="chart-section">
                    <h4>전류-온도 관계 그래프</h4>
                    <canvas id="performance-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- 절연저항 열화 패턴 분류 모드 -->
        <div id="degradation-mode" class="mode-content">
            <h2>절연저항 열화 패턴 분류</h2>

            <!-- 파일 업로드 섹션 -->
            <div class="input-section">
                <h3 style="color: #667eea; margin-bottom: 15px;">📁 파일 업로드</h3>
                <div class="input-group">
                    <label for="file-input">Excel 또는 CSV 파일 업로드:</label>
                    <input type="file" id="file-input" accept=".xlsx,.xls,.csv" style="padding: 10px;">
                    <small>Excel(.xlsx, .xls) 또는 CSV 파일을 선택하세요. 첫 번째 열: 연도, 두 번째 열: 월, 세 번째 열: 절연저항(MΩ)</small>
                </div>
                <button id="upload-file" class="calculate-btn" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">파일 업로드</button>
            </div>

            <!-- 수동 입력 섹션 -->
            <div class="input-section" style="margin-top: 30px;">
                <h3 style="color: #667eea; margin-bottom: 15px;">✏️ 수동 입력</h3>

                <!-- 데이터 입력 테이블 -->
                <div id="data-input-table-container">
                    <table id="data-input-table" style="width: 100%; margin-bottom: 15px;">
                        <thead>
                            <tr>
                                <th style="width: 30%;">연도 (YYYY)</th>
                                <th style="width: 30%;">월 (MM)</th>
                                <th style="width: 30%;">절연저항 (MΩ)</th>
                                <th style="width: 10%;">삭제</th>
                            </tr>
                        </thead>
                        <tbody id="data-input-tbody">
                            <!-- 데이터 행이 여기에 추가됩니다 -->
                        </tbody>
                    </table>
                </div>

                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button id="add-data-row" class="secondary-btn">➕ 행 추가</button>
                    <button id="clear-data-table" class="secondary-btn" style="background: #dc3545;">🗑️ 전체 삭제</button>
                </div>

                <button id="calculate-degradation" class="calculate-btn">패턴 분류</button>
            </div>

            <div id="degradation-results" class="results-section" style="display: none;">
                <h3>분류 결과</h3>
                <div id="degradation-result-content" class="result-content">
                </div>
            </div>

            <!-- 절연저항 열화 패턴 분류 기록 목록 -->
            <div class="history-section">
                <div class="history-header">
                    <h3>평가 기록</h3>
                    <button id="clear-degradation-history" class="clear-btn-small">전체 삭제</button>
                </div>
                <div id="degradation-history-list" class="history-list">
                    <!-- 기록 목록이 여기에 표시됩니다 -->
                </div>
                <!-- 그래프 섹션 -->
                <div class="chart-section">
                    <h4>절연저항 추이 그래프</h4>
                    <canvas id="degradation-chart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>

